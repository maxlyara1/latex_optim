\ProvidesFile{lecture08.tex}[Лекция 8]

\newpage

\section{Лекция №8. Определение первоначального допустимого базисного решеения. Особые случаи симплексного метода. Двойственные задачи линейного программирования.}
\subsection{Определение первоначального доспустимого базисного решения}
Базисные решения, получаемые на I шаге, не всегда являются допустимыми.\\
Рассмотрим один из алгоритмов получения допустимого базисного решения (ДБР):\\
\textbf{1.} Если в каждом уравнении дополнительная переменная и свободный член, стоящий в правой части, имеют одинаковые знаки, 
то дополнительные переменные берём в качестве базисных и при этом получаем ДБР.\\
\textbf{2.} Если хотя бы в одном уравнении дополнительная переменная и свободный член 've противоположные знаки (и дополнительные переменные --- в качестве базисных,
то есть 1 базисное решение get-ся недопустимым), то в системе (1) (в которой базисные выражаются через свободные) рассм-ем $\forall$ ур-е с отрицательынм свободным членом и переводим в базисные $\forall$  из свободных переменных, входящих в это уравнение с положительным коэфицентом. \\ 
Процедура повторяется до достижения ДБР.
При этом (при возможности выбора) следует переводить из свободных в базисные ту свободную переменную, которая def-т в качестве разрешающего уравнения с отрицательным свободным членом.
Только в этом случае новые базисные решения будут иметь меньше отрицательных компонент.\\
\textbf{3.} Если базисное решения недопустимое и в уравнениях с отрицательным свободным членом $\nexists$  свободных переменных с положительным коэффицентами, то $\nexists$ ДБР (то есть условия ЗЛП противоречивы). \\
\textbf{ex:}\\ 
$F=x_1+x_2 \rightarrow max$
при \eqn{
    \begin{cases}
    x_1-x_2 \leq-1 \\
    x_1-x_2 \geq-3 \\
    x_1 \leq3\\
    x_1, x_2 \geq0
    \end{cases}
}
В каноническом виде 
\eqn{
    \begin{cases}
        x_1-x_2+x_3 \ \ \ \ \ \ \ \ \ \ \ \ \ \ =-1 \\
        x_1-x_2 \ \ \ \ \ \ -x_4 \ \ \ \ \ \ \ \ = -3 \\
        x_1 \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ + x_5 =3 \\
        x_i \geq0 \ (i=\overline{1,5})
    \end{cases}
}
\textbf{I шаг}\\
В соответствии с правилом со стр. ??? в качестве базисных берём дополнительные переменные $\{x_3, x_4, x_5\}$ ; свободные - $\{x_1, x_2\}$. Базисные --- через свободные:
\eqn{
    \begin{cases}
        x_3 = \fbox{-1}-x_1+x_2 \\
        x_4 = \fbox3+x_1-x_2\\
        x_5 = \fbox3-x_1
    \end{cases}
} $\Rightarrow$ базисное решение $X_1 = (0;0;-1;3;3)$ - не является допустимым, то есть оно $\notin$ многоугольнику решений $\Rightarrow \nexists F(X_1)$ \\
Уравнение с отрицательным свободным членом --- 1-ое, в нём с положительным коэфицентом --- $''x_2'' \Rightarrow $ её в базисные (так как при этом будет увеличиваться $''x_3''$) \\
Оценочные отношения $\Rightarrow$ Наибольшее возможное зачение: $x_2 = min \{1;3; \infty \} \Rightarrow$ 1-ое уравнение \fbox {$x_3 = -1-x_1+x_2$} --- разрешающее \\
\textbf{II шаг}\\
Базисные --- $\{x_2; x_4; x_5\}$ ; свободные --- $\{x_1, x_3\}$\\
\eqn{
    \begin{cases}
        x_2 = \fbox1+x_1+x_3 \\
        x_4 = \fbox3+x_1-(1+x_1+x_3)=2\\
        x_5 = \fbox3-x_1
    \end{cases}
} 
$\Rightarrow$ get ДБР: $X_2=(0;1;0;2;3)$; \\
\eqn{
    F=x_1+(1+x_1+x_3)=1+2x_1+x_3;
}
\cent{
    $F(X_2)=1 \neq F_{max}$
}
$\Rightarrow$ следующий шаг симплексного метода(так как в F есть положительные коэффиценты, а значит он не max)...
\subsection{Взаимно двойственные задачи линейного программирования(ЗЛП), их свойства. Основное неравенство теории двойственности. Первая(основная) теорма двойственности. Вторая теорема двойственности.}
\subsubsection{Взаимно двойственные задачи ЛП и их свойства}
$\forall$ ЗЛП соответствует двойственная (сопряжённая) ей задача ЗЛП.\\
\textbf{ex:} (см стр. ??? об use-нии ресурсов):\\
Из ресурсов $S_i$ (i= $\overline{1,m}$) с запасами $b_i (i= \overline{1,m})$ изготваливаются виды продукции $P_j (j= \overline{1,n})$ в количестве $x_j (j= \overline{1,n})$. Технологические коэффиценты --- $a_{ij} (i= \overline{1,m}, j= \overline{1,n})$ ---
число единиц ресурса $S_i$ затративших на изготовление одной единицы продукции $p_j$. Прибыль(выручка) от реализации единицы продукции $P_j$ --- $c_j, (j= \overline{1,n})$ (то есть цена единицы продукции $P_j$).\\
Целевая фунция:\\ $F = \Sigma_{j=1}^n c_j*x_j \rightarrow max $ --- прибыль от реализации всей продукции. \\
При ограничениях:\\ $\Sigma_{j=1}^n a_{ij}*x_j \leq b_i$, ($i=\overline{1,m}$)\\

Пусть другая организация хочет купить у этого предприятия все ресурсы $S_i$ ($i=\overline{1,m})$.\\
Целевая функция(для другой организации, так как они хотят купить как можно дешевле):\\ $Z = \Sigma_{i=1}^m b_i*y_i \rightarrow min$ --- затраты на покупку всех ресурсов по ценам $''y_i''$; \\
При ограничениях: \\ $Z = \Sigma_{i=1}^m a_{ij}*y_i \geq c_j, (j=\overline{1,n})$ --- выручка продавца (предприятия) должна быть не менее той суммы, которую предприятие может получить при переработке ресурсов $S_i$ в готовую продукцию $P_j$.\\
\newpage
\subsubsection{Экономико-математическая модель исходной и двойственной задач:}
\textbf{Задача I (исходная):}
\eqn{
    F=c_1x_1+...+c_nx_n \rightarrow max \ \ (1)
}
\eqn{
    \begin{cases}
    a_{11}x_1+a_{12}x_2+...+a_{1n}x_n \leq b_1\\
    \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  \ \  \ \ \dots \ \ \ \ \ \ \ \ \ \  \ \ \ \ \ \ \ \ \ \ \ \ \ (2)\\
    a_{m1}x_1+a_{m2}x_2+...+a_{mn}x_n \leq b_m
    \end{cases}
}
\eqn{x_j \geq0 \ (i=\overline{1,n}) \ \ \ (3)}
Найти: план выпуска продукции $X=(x_1,...,x_n)$, прибыль от её реализации $F=F_{max}$, при условии, что потребление ресурсов $S_i$ не превзойдёт запасов $b_i$

\textbf{Задача II (двойственная):}
\eqn{
    Z=b_1y_1+...+b_ny_n \rightarrow min \ \ (4)
}
\eqn{
    \begin{cases}
    a_{11}y_1+a_{12}y_2+...+a_{1n}y_m \geq c_1\\
    \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  \ \  \ \ \dots \ \ \ \ \ \ \ \ \ \  \ \ \ \ \ \ \ \ \ \ \ \ \ (5)\\
    a_{1n}y_1+a_{2n}y_2+...+a_{mn}y_m \geq c_n
    \end{cases}
}
\eqn{y_j \geq0 \ (i=\overline{1,m}) \ \ \ (6)}
Найти: набор цен(оценок ресурсов) $Y=(y_1,...,y_n)$, общие затраты на ресурсы $Z=Z_{min}$, при условии, что затраты на ресурсы при производстве продукции $P_j$ не менее прибыли от её реализации $c_j$
\\
\subsubsection{Свойства взаимно двойственных задач:}
\textbf{1.} В одной задаче $\rightarrow$ max, в другой --- $\rightarrow$ min\\
\textbf{2.} Коэффиценты целевой функции одной задачи --- свободные члены системы ограничений другой задачи\\
\textbf{3.} Обе ЗЛП --- в стандартной форме; в задаче max-ции неравенства вида $\leq$ --- в min-ции --- $\leq$\\
\textbf{4.} Матрицы системы ограничений транспонированные друг к другу\\
\textbf{5.} Число неравенств системы ограничений одной задачи --- число переменных другой задачи\\
\textbf{6.} В обеих задачах неотрицательные переменные
\subsubsection{Алгоритм составления двойственной задачи}
\textbf{1.} Все неравенства к одному виду: if max --- $\leq$, if min --- $\geq$\\
\textbf{2.} Составить расширенную матрицу исходной системы: дописываем n+1 столбец свободных членов, m+1 строка --- строка коэффицентов целевой функции.\\
\textbf{3.} Транспонируем её\\
\textbf{4.} Формулируем двойственную задачу на основе этой матрицы. \\
Будет n ограничений, m переменных. \\
Последняя n+1 строка --- бывшие коэффиценты свободных членов в исходной матрице. Они теперь являются коэффицентами целевой функции двойственной задачи(Z)\\
Столбец свободных членов n+1 в исходной задаче --- матрица коэффицентов целевой функции F. Теперь это вектор свободных членов в системе ограничений для двойственной задачи.\\
\textbf{ex:} \\
Исходная ЗЛП:\\
\eqn{
    F=-x_1+2x_2 \rightarrow max
}
\eqn{
    \begin{cases}
        2x_1-x_2\geq1\\
        -x_1+4x_2\leq24\\
        x_1-x_2\leq3\\
        x_1+x_2\geq5\\
        x_1\geq0; x_2\geq0
    \end{cases}
    \Rightarrow m=4; n=2
} 
\textbf{Пункт №1.} Приводим неравенства данной задачи max-ции к виду ''$\leq$''
\eqn{
    \begin{cases}
        -2x_1+x_2\leq1\\
        -x_1+4x_2\leq24\\
        x_1-x_2\leq3\\
        -x_1-x_2\leq5\\
        x_1\geq0; x_2\geq0
    \end{cases}
}
\textbf{Пункт №2.} Составляем расширенную матрицу системы.\\
\eqn{
    A=
    \left(\begin{array}{cc|c}  
        -2 & 1 & -1\\  
        -1 & 4 & 24 \\
        1 & -1 & 3 \\
        -1 & -1 & -5 \\
        \hline
        -1 & 2 & F \\
    \end{array}\right)
}
\textbf{Пункт №3.} Составляем расширенную матрицу двойственной задачи (Транспонировали предыдущую)\\
\eqn{
    A'=
    \left(\begin{array}{cccc|c}  
        -2 & -1 & 1 & -1 & -1\\  
        1 & 4 & -1 & -1 & 2\\
        \hline
        -1 & 24 & 3 & -5 & Z\\
    \end{array}\right)
}
\textbf{Пункт №4.} Двойственная ЗЛП:\\
\eqn{
    z=-y_1+24y_2+3y_3-5y_4 \rightarrow min;
}
\cent{при}
\eqn{
    \begin{cases}
        -2y_1-y_2+y_3-y_4\geq-1\\
        y_1+4y_2-y_3-y_4\geq2\\
        y_i, (i=\overline{1,4})
    \end{cases}
}
\subsubsection{Теорема. Основное неравенство теории двойственности}
\textbf{Основное неравенство:}\\
$\forall$ пары допустимых решений исходной $X=(x_1,...,x_n)$ и двойственной $Y=(y_1,...,y_m)$ имеем:\\
$F(X) \leq Z(Y)$, то есть $\Sigma_{j=1}^n c_jx_j \leq \Sigma_{i=1}^m b_iy_i$\\
\textbf{Доказательство:}\\
Умножим каждое '' i ''-ое неравенство системы ограничений задачи I (2) на неотрицательную переменную $y_i (i=\overline{1,m})$ и сложим все неравенства, то есть:\\
\eqn{
    \Sigma_{j=1}^n a_{ij} x_j \leq b_i | *y_i \Rightarrow \Sigma_{i=1}^m y_i*(\Sigma_{j=1}^na_{ij} x_j) \leq \Sigma_{i=1}^m b_i y_i \fbox{=Z(Y)}
}
Аналогично каждое '' j '' неравенство задачи II (5) --- на $x_j (j=\overline{1,n})$ и сложим, то есть:\\
\eqn{
    \Sigma_{i=1}^m a_{ij} y_i \geq c_j | *x_j \Rightarrow \Sigma_{j=1}^n x_j*(\Sigma_{i=1}^ma_{ij} y_i) \geq \Sigma_{j=1}^n c_j x_j \fbox{=F(X)}
}
Таким образом get-уем:\\
\eqn{
    F(X) \leq \Sigma_{i=1}^m \Sigma_{j=1}^n a_{ij} x_j y_i \leq Z(Y)
}
то, что по центру это как раз и есть то общее, что было в предыдущих двух неравенствах
\qedsymbol\\
\subsubsection{Теорема. Достаточный признак оптимальности:}
if $X^*=(x_1^*,...,x_n^*), Y^*=(y_1^*)$ --- допустимые решения взаимно-двойственных задач и 
\eqn{
    F(X^*) = Z(Y^*) (7) \Rightarrow
}
$\Rightarrow then \ X^* =X_{max}, Y^*=Y_{min}$ (то есть это оптимальные решения своих задач)\\
\subsubsection{Первая(основная) теорема двойственности.}
\textbf{1.} Если существует оптимальное решение одной из взаимно-двойственных задач $\Rightarrow$ then $\exists$ решение другой задачи и они равны:\\
\eqn{
    F_{max} = Z_{min} \ or \ F(X^*)=Z(Y^*)
}
\textbf{2.} if целевая функция одной из задач неограниченая $\Rightarrow$ then условия другой задачи противоречивы.\\
\textbf{Доказательство:}\\
\textbf{1)} Первая часть --- без доказательства. Но, таким образом, равенство(7) --- не только достаточный, но и необходимый признак оптимальности решений взаимно двойственных задач, то есть\\
\eqn{
    F(X^*)=Z(Y^*) \Leftrightarrow X^*=X_{max}, Y^*=Y_{min}.
}
\textbf{2)} Вторая часть доказывается от противного.\\
Пусть $F_{max}=\infty$, а условия другой задачи не является противоречивыми, то есть $\exists$ допустимое решение $Y=(y_1,..., y_m) \Rightarrow \forall X : F(X) \leq Z(Y) \Rightarrow \nexists$ допустимых решений Y. \qedsymbol\\
\textbf{ex:}\\
\textbf{I} \\
$F=2x_1+3x_2 \rightarrow max$
\eqn{
    \begin{cases}
        x_1+3x_2\leq18\\
        2x_1+x_2\leq16\\
        \ \ \ \ \ \ \ \ x_2\leq5\\
        3x_1 \ \ \ \ \ \ \leq21\\
        x_i \geq 0 (i=\overline{1,2})
    \end{cases}
}
\textbf{II}\\
$Z=18y_1+16y_2+5y_3+21y_4 \rightarrow min$
\eqn{
    \begin{cases}
        y_1+2y_2 \ \ \ \ \ + 3y_4 \geq2\\
        3y_1+y_2 +y_3 \ \ \ \ \ \ \geq3\\
        y_i \geq 0 (i=\overline{1,4})
    \end{cases}
}
$F_{max}=24$, значит можно сделать вывод о том, что $Z_{min}=24$ и наоборот.
\subsubsection{Экономический смысл первой(основной теоремы)}
План производства $X^*=(x_1^*,...x_n^*)$ и набор цен(оценок) ресурсов $Y^*=(y_1^*,...y_m^*) $ оптимальны $\Leftrightarrow$ прибыль(выручка) от продукции $F(X)$ равная затратам на ресурсы $Z(Y)$.\\
Для других планов X и Y прибыль (выручка) от продукции всегда меньше затрат на ресурсы. \\
Таким образом, предприятию безразлично либо \\1) производить продукцию по оптимальному плану $X^*$, либо \\2) продавать ресурсы по оптимальному плану $Y^*$ и возместить от продажи равные $F_{max}$ затраты на ресурсы $Z_{min}$.\\
\subsubsection{Вторая теорема двойственности}
Две взаимно двойственные ЗЛП характеризуются не только равенством оптимальных значений их целевых функций, а также взаимосвязью между первоначальными переменными одной из задач и дополнительными переменными другой задачи в их оптимальных ДБР $X^*$ и $Y^*$\\
Рассмотрим взаимно двойственные задачи со стр. ??? . Для решения их симплексным методом они должны быть приведены к каноническому виду путем введения в систему ограничений дополнительных неотрицательных переменных: