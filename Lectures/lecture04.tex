
\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{ulem}
\usepackage{upgreek}
\usepackage[T2A]{fontenc}
\usepackage[english,russian]{babel}
\usepackage[left=25mm, top=20mm, right=25mm, bottom=30mm, nohead, nofoot]{geometry}
\usepackage{amsmath,amsfonts,amssymb} % математический пакет
\usepackage{fancybox,fancyhdr}
\usepackage{graphicx}%Вставка картинок правильная
\usepackage{float}%"Плавающие" картинки
\usepackage{wrapfig}%Обтекание фигур (таблиц, картинок и прочего)
\usepackage{xcolor}
\usepackage{hyperref}
\hypersetup{colorlinks=true, allcolors=[RGB]{010,090,200}} % цвет ссылок
\newtheorem{theorem}{Теорема}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}[theorem]{Лемма}

\newcommand{\lr}[1]{\left({#1}\right)}

\begin{document}
\Large
\section*{Лекция №4}
\section*{Выпуклые и вогнутые функции}

Пусть функция $"f(x)"$, def-на на множестве $M \subset R^n$ (т.е. $x = (x_1, ... , x_n) \in M$ \\

\textbf{def:} График функции $"f(x)"$  - это множество $\Gamma(f) \subset R^{n+1}$ состоящее из точек $(x, f(x) = (x_1, ... , x_n, f(x))$, где $x \in M$. \\

\textbf{def:} Надграфик функции $"f(x)"$  - это множество $\Gamma(f) \subset R^{n+1}$, состоящее из точек $(x, x_{n+1}) = (x_1, ..., x_n, x_{n+1})$, где $x \in M$, $x_{n+1} \leqslant f(x)$ \\

\textbf{def:} Функция $"f(x)"$, заданная на множестве $m \subset R^n$ наз-ся выпуклой, если ее надграфик $\Gamma(f)$ является выпуклым множеством в $R^{n+1}$ \\

\textbf{Rem:} Функция $"f(x)"$ вогнута $\leftrightarrow$ функция -$"f(x)"$ выпукла. \\

Кроме данного геометрического def-я выпуклых (вогнутых) функций, часто use-ся следующее аналитическое def-е:
def: Функция $"f(x)"$, заданная на множестве $M \subset R^n$ наз-ся выпуклой(вогнутой), если 1) M - выпуклое, 2) $\forall x_1 \in M, x_2 \in M$ и числа $t \in [0,1]$ 've:\\
$f((1-t)*x_1+tx_2) \leqslant (1-t)*f(x_1) + t * f(x_2)$ (1) \\
($\geqslant$ - для вогнутой функции) \\

\textbf{Rem:} 1) Можно показать, что геометрические и аналитические def- я эквивалентны; (Rem: $(1-t)*f(x_1) + t * f(x_2)$ - уравнение отрезка $[x_1, x_2] (t \in [0, 1])$ при $x_1 \neq x_2$ и $t \in (0,1)$)\\
2) Если (1) 've строгое неравенство $\Rightarrow$, то функция $"f(x)"$ наз-ся строго выпуклой (строго вогнутой). \\
3) 
\subsection*{Свойства выпуклых (вогнутых) функций}
\textbf{1.} $f(x) = const$ и $f(x) = ax + b$ всюду выпуклы (вогнуты). \\
\textbf{2.} \textit{if} функции $f_i(x) (i = \overline{1, m})$, заданные на $M \subset R^n$, выпуклы $\Rightarrow$ \\
\textit{then} функция $f(x) = \sum_{i = 1}^m \alpha_i f_i(x)$ выпукла (при $\forall \alpha_i \geqslant 0$) \\
\textbf{3.} \textit{if} функция $"f(x)"$, заданная на выпуклом множестве $M \subset R^n$, выпукла $\rightarrow$ \\
\textit{then} $\forall  "\alpha"$ множество решений неравенства $f(x) \leqslant \alpha$, т.е. множество $M_{\alpha} =$ $\{ x \in M: f(x) \leqslant \alpha \}$, является выпуклым. \\
\textbf{3.1} \textit{if} функции $f_1(x), ... , f_m(x)$, заданные на выпуклом множестве $M \subset R^n$, выпуклы $\Rightarrow$ \\
\textit{then} множество решений системы неравенств $f_i(x) \leqslant \alpha_i$ ($i = \overline{1, m}$) является выпуклым. \\
\textbf{4.} Выпуклая (вогнутая) функция, заданная на выпуклом множестве $M \subset R^n$, непрерывна в $\forall$ внутренней точке множества. \\
(вставка на страницу 25) \\
\textbf{def:} Выпуклая оболочка множества - это совокупность всех выпуклых линейных комбинаций его конечных подмножеств $\{x_1, ... , x_k$ (где $x_i \in M$). (Конечное подмножество - это конечный набор точек $x_1, ... , x_k$) 
\subsection*{Теорема (Крейна-Мильмана)} 
Выпуклый компакт в нормированном пространстве является выпуклой оболочкой своих угловых (крайних) точек.
\subsection*{Теорема}
Пусть выпуклая (вогнутая) функция $"f(x)"$ задана на выпуклом множестве $M \subset R^n \Rightarrow$ \\
Каждый локальный минимум (максимум) функции $"f(x)"$ является её глобальным минимумом (максимумом) на множестве M. \\
\textbf{Доказательство (для выпуклой функции)} \\
Пусть точка $x^* \in M$ - точка локального min-a. Пусть точка точка $x \in M$ - произвольная точка множества M. Need доказать: $f(x) \geqslant f(x^*)$. \\
Отрезок $[x^*, x] = (1 - t_0)x^* + tx$ ($t \in [0, 1]$) принадлежит "M". При малом значении $t_0 \in (0, 1)$ /-щая точка отрезка $[x^*, x]$ находится в малой окресности т.$x^*$, в котором имеем: \\
$f((1 - t_0)x^* + t_0x) \geqslant f(x^*)$ \\
Из def-я выпуклой функции $f(x)$ 've: \\
$f((1 - t_0)x^* + t_0x) \leqslant (1 - t_0)f(x^*) + t_0f(x)$ \\
Т.о. : \\
$(1 - t_0)*f(x^*) + t_0*f(x) \geqslant f(x^*) \Rightarrow$ \\
$\Rightarrow f(x) \geqslant f(x^*)$ ч. и т.д. (для вогнутой $"f(x)"$ доказательство аналогичное.) \\

\textbf{Rem: } \\
1) Задачи выпуклой оптимизации называются одноэкстремальными. В многоэкстремальных задачах может $\exists$-ть локальные экстремумы, не совпадающие в глобальными. \\
2) Одноэкстремальность задач выпуклой оптимизации не означает, что каждая такая задача имеет решение и при том единственное. f.e.: 1) Выпуклая функция одной переменной $f(x) = x$, при $x \in (0,1)$ не достигает min-a (и max-a) на $(0,1)$; 2) Множество точек min-a выпуклой фукнции $f(x) = C$ - const, $x \in M$, совпадает со всем M. \\
3) Если функция $"f(x)"$ - строго выпуклая (строго вогнутая), то разрешимая задача выпуклой оптимизации (т.е. множество $M \neq \varnothing$ и ограничено) имеет единственное решение. \\
\textbf{def:} Производной $\frac{\partial f(x)}{\partial \ell}$ функции $f(x) = f(x_1, ... , x_n)$ по направлению ненулевого единичного вектора $\ell = (\ell_1, ... , \ell_n)$ в т. $x = (x_1, ... , x_n)$ называется предел \\
$$
\frac{\partial f(x)}{\partial \ell} = \lim_{\lambda\to\\+0} \frac{f(x + \lambda \ell) - f(x)}{\lambda}
$$

Если функция дифференциируема в т. $x$, то она в этой точке производную по $\forall$ направлению $\ell = (\ell_1, ... , \ell_n)$, которая выражается через частные производные по следующей формуле: 
$$
\frac{\partial f(x)}{\partial \ell} = \sum_{i = 1}^{n} \frac{\partial f(x)}{\partial x_i} \ell_i
$$

\newpage

Производная по направлению равна скалярному произведению вектора $"\ell"$ и вектора градиента функции $"f(x)"$ в т. $x$ \\
$$\nabla f(x) = \left(\frac{\partial f(x)}{\partial x_1} , ... , \frac{\partial fx)}{\partial f(x_n)}\right): \frac{\partial f(x)}{\partial \ell} = \nabla f(x) * \ell = \nabla f(x) * |\ell|$$
или \\
$$\frac{\partial f(x)}{\partial \ell} = |f(x)| * |\ell| * \cos{\phi}$$
Т.о.: \\
$\forall$ направления $"\ell"$ производная $\frac{\partial f}{\partial \ell} \leqslant |\nabla f(x)|$. \\
$\Rightarrow$ Вывод: \\
1) Производная по направлению $"\frac{\partial f}{\partial \ell}"$ - это скорость изменения функции $"f(x)"$ по направлению $"\ell"$(знак $"\frac{\partial f}{\partial \ell}"$ - это характер изменения функции(возрастание или убывание)). \\
2) Направление градиента $\nabla f(x)$ - это направление наибольшего возрастания функции $"f(x)"$ в т. $x$; длина градиента $"|\nabla f(x)|"$ равна наибольшей скорости возрастания функции в этой точке. \\
\subsection*{Теорема} 
Пусть 've дифференциируемую выпуклую функцию $"f(x)"$, def-ую на выпуклом множестве $M \subset R^n$. \\
1) $\forall x, y \in M$ 've: $\lambda f(x) * (y-x) \leqslant f(y) - f(x)$ \\
2) т. $x^* \in absminf \Leftrightarrow \nabla f(x^*) = 0$ (2) \\
\subsection*{Теорема (дифференциальный признак выпуклых функций)}
Дважды дифференциируемая функция $"f(x)"$, def-ная на выпуклом множестве $M \subset R^n$ является выпуклой $\Leftrightarrow \forall x = (x_1, ... , x_n) \in M$ и $\forall \ell = (ell_1, ... , \ell_n) \in R^n$ \\
've: 
$$ \sum_{i = 1}^n \sum_{j=1}^n \frac{\partial^2 f(x)}{\partial x_i \partial x_j} \ell_i \ell_j \geqslant 0, (3) $$
т.е. гессиан функции всюду неотрицательно определён: \\
$$ A = f''(x) = \left(\frac{\partial^2 f(x)}{\partial x_i \partial x_j} \right) \geqslant 0, (\forall x \in M)$$
\textbf{Rem:} \\
1) Функция является строго выпуклой $\Leftrightarrow$ гессиан положительно определён, т.е. 
$$ \left(\frac{\partial^2 f(x)}{\partial x_i \partial x_j}\right) > 0, (\forall x \in M)$$
2) Знакоопределённость гессиана устанавливается с помощью критерия Сильвестра.
\newpage
\textbf{ex 1:} \\
Проверить выпуклость функции: \\
$f(x_1, x_2) = 4x_1 + x_2^2 - 2x_1x_2 + 6x_1 - 5x_2 - 2$ \\
$f'_{x1} = 8x_1 =2x_2 + 6$;
$f''{x_1x_1} = 8$;
$f''_{x_1x_2} = -2$;
$f''{x_2x_2} = 2$;
$f'_{x2} = 2x_2 - 2x_1 - 5$ \\
Гессиан А = 
\begin{pmatrix}
8 & -2 \\
-2 & 2 \\
\end{pmatrix} ;
$\Delta_1 = 8 > 0; \Delta_2 = 12 > 0$ \\
$\Rightarrow$ функция является строго выпуклой. \\
\textbf{ex 2:} \\
Проверить выпуклость функции: 
$f(x) = -\sqrt{x_1x_2}$ на множестве \\
$M = \{ (x_1, x_2)| x_1 > 0, x_2 > 0\}$. \\
$f'_{x1} = -\frac{1 * x_2}{2 \sqrt{x_1 x_2}} = - \frac{1}{2} \sqrt{\frac{x_2}{x_1}}$; \\
$f'_{x2} = - \frac{1}{2} \sqrt{\frac{x_1}{x_2}}$; \\
$f''{x_1x_1} = (- \frac{\sqrt{x_2}}{2} * x_1^{-\frac{1}{2}})' = \frac{1}{4} \frac{\sqrt{x_2}}{\sqrt{x_1^3}} = \frac{1}{4 x_1} \sqrt{\frac{x_2}{x_1}}$; \\
$f''_{x_1x_2} = - (\frac{1}{2 \sqrt{x_1}} * x_2^{\frac{1}{2}})' = \frac{1}{4 \sqrt{x_1 x_2}}$; \\
$f''{x_2x_2} = (- \frac{1 * \sqrt{x_1}}{2} * x_2^{- \frac{1}{2}})' = \frac{1 \sqrt{x_1}}{4 \sqrt{x_2^3}} = \frac{1}{4x_2} * \sqrt{\frac{x_1}{x_2}}$ \\
Гессиан H =
\begin{pmatrix}
\frac{1}{4x_1} * \sqrt{\frac{x_2}{x_1}} & - \frac{1}{4 \sqrt{x_1 x_2}} \\
- \frac{1}{4 \sqrt{x_1 x_2}} & \frac{1}{4x_1} * \sqrt{\frac{x_1}{x_2}} \\
\end{pmatrix} \\
$\Delta_1 = \frac{1}{4x_1} \sqrt{\frac{x_2}{x_1}} > 0 (\forall x_1, x_2 > 0)$; \\
$\Delta_2 = \frac{1}{16 x_1 x_2} \sqrt{\frac{x_2 x_1}{x_1 x_2}} - \frac{1}{16 x_1 x_2} = 0 \Rightarrow$ \\
Гессиан Н $\geqslant 0 \Rightarrow$ функция является на множестве $M = \{ (x_1, x_2) | x_1 > 0, x_2 >0 \}$ выпуклой (но не является строго выпуклой).


\end{document}